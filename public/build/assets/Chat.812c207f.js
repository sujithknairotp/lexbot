import{j as r,b,d as n,a as f,e,F as v,l as y,w,f as x,v as k,p as M,o as l,n as E,g as S,m as T,h as V}from"./app.bf19c1bf.js";import{A as u}from"./API.5d8e0a62.js";import{_ as B}from"./TheNavbar.cfd3e61d.js";const F={class:"container mx-auto mt-8"},j={class:"flex items-center justify-center min-h-screen"},A={class:"rounded-xl border p-5 shadow-md w-9/12 bg-white"},C={class:"row mb-2"},K=["id"],L=["innerHTML"],N=e("br",null,null,-1),Y=["onSubmit"],z=e("label",{for:"chat",class:"sr-only"},"Your message",-1),D={class:"flex items-center py-2 px-3 bg-gray-50 rounded-lg dark:bg-gray-700"},H=["onKeyup"],R=e("button",{type:"submit",class:"inline-flex justify-center p-2 text-blue-600 rounded-full cursor-pointer hover:bg-blue-100 dark:text-blue-500 dark:hover:bg-gray-600"},[e("svg",{"aria-hidden":"true",class:"w-6 h-6 rotate-90",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})]),e("span",{class:"sr-only"},"Send message")],-1),$={name:"Chat",setup(q){const m=V,d=r([]),a=r(""),g=r(!1);b(()=>{console.log("chat started"),h()});const h=async()=>{try{const s=await u.post("/chat/init");console.group("init message"),console.log(s.data),console.groupEnd(),i(s.data.messages),a.value=""}catch(s){console.error(s)}},p=async s=>{try{const t=await u.post("/chat/send",{message:s});console.log(t.data),t.data.dialogState=="ReadyForFulfillment"&&(g.value=!0,setTimeout(()=>{m.push({name:"dashboard"})},1e3)),i(t.data.messages),a.value=""}catch(t){console.error(t)}},c=()=>{a.value.trim()&&(console.log("new message ref trim"),p(a.value.trim()))},i=s=>{s&&(console.group("fetch messages"),console.log(s),console.groupEnd(),s.forEach(t=>{d.value.push(t)}))};return(s,t)=>(l(),n("div",null,[f(B),e("div",F,[e("div",j,[e("div",A,[e("div",C,[(l(!0),n(v,null,y(d.value,(o,_)=>(l(),n("div",{class:"mb-2",key:o.id},[e("label",{id:_,class:E(o.sender_name==o.sender_id?"col-md-12 text-md-start":"col-md-12 text-md-end")},[S(T(o.sender_name?o.sender_name:"You")+" : ",1),e("div",{innerHTML:o.message},null,8,L)],10,K)]))),128)),N]),e("form",{onSubmit:w(c,["prevent"])},[z,e("div",D,[x(e("textarea",{id:"chat",rows:"1",class:"block mx-4 p-2.5 w-full text-sm text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Your message...",required:"","onUpdate:modelValue":t[0]||(t[0]=o=>a.value=o),onKeyup:M(c,["enter"])},null,40,H),[[k,a.value]]),R])],40,Y)])])])]))}};export{$ as default};
